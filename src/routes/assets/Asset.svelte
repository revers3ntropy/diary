<script lang="ts" ✂prettier:content✂="CiAgICBpbXBvcnQgeyB0b29sdGlwIH0gZnJvbSAnQHN2ZWx0ZS1wbHVnaW5zL3Rvb2x0aXBzJzsKICAgIGltcG9ydCB7IGNyZWF0ZUV2ZW50RGlzcGF0Y2hlciwgb25Nb3VudCB9IGZyb20gJ3N2ZWx0ZSc7CiAgICBpbXBvcnQgQ2hlY2sgZnJvbSAnc3ZlbHRlLW1hdGVyaWFsLWljb25zL0NoZWNrLnN2ZWx0ZSc7CiAgICBpbXBvcnQgQ29udGVudENvcHkgZnJvbSAnc3ZlbHRlLW1hdGVyaWFsLWljb25zL0NvbnRlbnRDb3B5LnN2ZWx0ZSc7CiAgICBpbXBvcnQgRGVsZXRlIGZyb20gJ3N2ZWx0ZS1tYXRlcmlhbC1pY29ucy9EZWxldGUuc3ZlbHRlJzsKICAgIGltcG9ydCBFeWUgZnJvbSAnc3ZlbHRlLW1hdGVyaWFsLWljb25zL0V5ZS5zdmVsdGUnOwogICAgaW1wb3J0IEV5ZU9mZiBmcm9tICdzdmVsdGUtbWF0ZXJpYWwtaWNvbnMvRXllT2ZmLnN2ZWx0ZSc7CiAgICBpbXBvcnQgeyBnZXROb3RpZmljYXRpb25zQ29udGV4dCB9IGZyb20gJ3N2ZWx0ZS1ub3RpZmljYXRpb25zJzsKICAgIGltcG9ydCBVdGNUaW1lIGZyb20gJy4uLy4uL2xpYi9jb21wb25lbnRzL1V0Y1RpbWUuc3ZlbHRlJzsKICAgIGltcG9ydCB7IEFzc2V0IH0gZnJvbSAnLi4vLi4vbGliL2NvbnRyb2xsZXJzL2Fzc2V0JzsKICAgIGltcG9ydCB0eXBlIHsgQXV0aCB9IGZyb20gJy4uLy4uL2xpYi9jb250cm9sbGVycy91c2VyJzsKICAgIGltcG9ydCB7IGFwaSwgYXBpUGF0aCB9IGZyb20gJy4uLy4uL2xpYi91dGlscy9hcGlSZXF1ZXN0JzsKICAgIGltcG9ydCB7CiAgICAgICAgZGlzcGxheU5vdGlmT25FcnIsCiAgICAgICAgU1VDQ0VTU19OT1RJRklDQVRJT04sCiAgICB9IGZyb20gJy4uLy4uL2xpYi91dGlscy9ub3RpZmljYXRpb25zJzsKICAgIGltcG9ydCB0eXBlIHsgVGltZXN0YW1wU2VjcyB9IGZyb20gJy4uLy4uL2xpYi91dGlscy90eXBlcyc7CgogICAgY29uc3QgeyBhZGROb3RpZmljYXRpb24gfSA9IGdldE5vdGlmaWNhdGlvbnNDb250ZXh0KCk7CiAgICBjb25zdCBkaXNwYXRjaCA9IGNyZWF0ZUV2ZW50RGlzcGF0Y2hlcigpOwoKICAgIGV4cG9ydCBsZXQgaWQ6IHN0cmluZzsKICAgIGV4cG9ydCBsZXQgcHVibGljSWQ6IHN0cmluZzsKICAgIGV4cG9ydCBsZXQgZmlsZU5hbWU6IHN0cmluZzsKICAgIGV4cG9ydCBsZXQgY29udGVudFR5cGU6IHN0cmluZzsKICAgIGV4cG9ydCBsZXQgY3JlYXRlZDogVGltZXN0YW1wU2VjczsKICAgIGV4cG9ydCBsZXQgb2JmdXNjYXRlZCA9IHRydWU7CiAgICBleHBvcnQgbGV0IGF1dGg6IEF1dGg7CgogICAgbGV0IHJlY2VudGx5Q29waWVkID0gZmFsc2U7CiAgICBsZXQgZGVsZXRlZCA9IGZhbHNlOwoKICAgIGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZUltZyAoKSB7CiAgICAgICAgaWYgKAogICAgICAgICAgICAhY29uZmlybSgKICAgICAgICAgICAgICAgICdBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHRoaXMgaW1hZ2U/ICcgKwogICAgICAgICAgICAgICAgJ1RoaXMgYWN0aW9uIGNhbm5vdCBiZSB1bmRvbmUgYW5kIHdpbGwgbGVhdmUnICsKICAgICAgICAgICAgICAgICcgYnJva2VuIGxpbmtzIGluIHlvdXIgZW50cmllcy4nLAogICAgICAgICAgICApCiAgICAgICAgKQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgZGlzcGxheU5vdGlmT25FcnIoCiAgICAgICAgICAgIGFkZE5vdGlmaWNhdGlvbiwKICAgICAgICAgICAgYXdhaXQgYXBpLmRlbGV0ZShhdXRoLCBhcGlQYXRoKGAvYXNzZXRzLz9gLCBwdWJsaWNJZCkpLAogICAgICAgICk7CiAgICAgICAgYWRkTm90aWZpY2F0aW9uKHsKICAgICAgICAgICAgLi4uU1VDQ0VTU19OT1RJRklDQVRJT04sCiAgICAgICAgICAgIHRleHQ6ICdEZWxldGVkIGFzc2V0JywKICAgICAgICB9KTsKICAgICAgICBkZWxldGVkID0gdHJ1ZTsKICAgICAgICBkaXNwYXRjaCgnZGVsZXRlJyk7CiAgICB9CgogICAgYXN5bmMgZnVuY3Rpb24gY29weVRvQ2xpcEJvYXJkICgpIHsKICAgICAgICByZWNlbnRseUNvcGllZCA9IHRydWU7CiAgICAgICAgYXdhaXQgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoCiAgICAgICAgICAgIEFzc2V0Lm1hcmtEb3duTGluayhmaWxlTmFtZSwgcHVibGljSWQpLAogICAgICAgICk7CiAgICAgICAgYWRkTm90aWZpY2F0aW9uKHsKICAgICAgICAgICAgLi4uU1VDQ0VTU19OT1RJRklDQVRJT04sCiAgICAgICAgICAgIHRleHQ6ICdDb3BpZWQgdG8gY2xpcGJvYXJkJywKICAgICAgICB9KTsKICAgICAgICBzZXRUaW1lb3V0KCgpID0+IChyZWNlbnRseUNvcGllZCA9IGZhbHNlKSwgMzAwMCk7CiAgICB9CgogICAgb25Nb3VudCgoKSA9PiAoZG9jdW1lbnQudGl0bGUgPSAnQXNzZXRzJykpOwo=">{}</script>

<div class="img-wrapper {deleted ? 'deleted' : ''}">
    <img
        alt="{fileName}"
        class="{obfuscated ? 'obfuscated' : ''}"
        loading="lazy"
        src="/api/assets/{publicId}"
    />
    <div class="menu">
        <div>
            <button
                aria-label="{obfuscated ? 'Show asset' : 'Hide asset'}"
                on:click="{() => (obfuscated = !obfuscated)}"
            >
                {#if obfuscated}
                    <Eye size="25" />
                {:else}
                    <EyeOff size="25" />
                {/if}
            </button>
            {#if !obfuscated}
                {#if recentlyCopied}
                    <Check size="30" />
                {:else}
                    <button
                        on:click="{copyToClipBoard}"
                        class="icon-button"
                        use:tooltip="{{
                            content: 'Copy link',
                            // `overflow: hidden` so needs to show below
                            position: 'bottom'
                        }}"
                    >
                        <ContentCopy size="30" />
                    </button>
                {/if}
            {/if}
        </div>
        <div>
            {#if !obfuscated}
                <!-- TODO use tzOffset from db -->
                <UtcTime
                    timestamp="{created}"
                    fmt="MMMM Do YYYY, h:mma"
                    tooltipPosition="bottom"
                />
            {/if}
        </div>
        <div>
            {#if !obfuscated}
                <button class="icon-button danger" on:click="{deleteImg}">
                    <Delete size="30" />
                </button>
            {/if}
        </div>
    </div>
</div>

<style lang="less" ✂prettier:content✂="CiAgICBAaW1wb3J0ICcuLi8uLi9zdHlsZXMvdmFyaWFibGVzJzsKICAgIEBpbXBvcnQgJy4uLy4uL3N0eWxlcy9sYXlvdXQnOwoKICAgIC5pbWctd3JhcHBlciB7CiAgICAgICAgLmJvcmRlcmVkKCk7CiAgICAgICAgLmZsZXgtY2VudGVyKCk7CgogICAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsKCiAgICAgICAgYm9yZGVyLXJhZGl1czogQGJvcmRlci1yYWRpdXM7CiAgICAgICAgbWFyZ2luOiAwLjVyZW07CgogICAgICAgIGhlaWdodDogNTB2aDsKICAgICAgICBhc3BlY3QtcmF0aW86IDEvMTsKICAgICAgICBvdmVyZmxvdzogaGlkZGVuOwoKICAgICAgICBpbWcgewogICAgICAgICAgICBtYXgtaGVpZ2h0OiAxMDAlOwogICAgICAgICAgICBtYXgtd2lkdGg6IDEwMCU7CgogICAgICAgICAgICAmLm9iZnVzY2F0ZWQgewogICAgICAgICAgICAgICAgZmlsdGVyOiBibHVyKDMwcHgpOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAubWVudSB7CiAgICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgICAgdG9wOiAwOwogICAgICAgICAgICByaWdodDogMDsKICAgICAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgICAgIGhlaWdodDogNTBweDsKICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogNXB4OwogICAgICAgICAgICBwYWRkaW5nOiA1cHg7CiAgICAgICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC41KTsKICAgICAgICAgICAgZGlzcGxheTogZmxleDsKICAgICAgICAgICAganVzdGlmeS1jb250ZW50OiBzcGFjZS1iZXR3ZWVuOwogICAgICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwoKICAgICAgICAgICAgJiA+ICogewogICAgICAgICAgICAgICAgLmZsZXgtY2VudGVyKCk7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgICYuZGVsZXRlZCB7CiAgICAgICAgICAgIGRpc3BsYXk6IG5vbmU7CiAgICAgICAgfQogICAgfQo="></style>
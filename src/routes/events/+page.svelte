<script lang="ts" ✂prettier:content✂="CiAgICBpbXBvcnQgeyBvbk1vdW50IH0gZnJvbSAnc3ZlbHRlJzsKICAgIGltcG9ydCBDYWxlbmRhciBmcm9tICdzdmVsdGUtbWF0ZXJpYWwtaWNvbnMvQ2FsZW5kYXIuc3ZlbHRlJzsKICAgIGltcG9ydCBQbHVzIGZyb20gJ3N2ZWx0ZS1tYXRlcmlhbC1pY29ucy9QbHVzLnN2ZWx0ZSc7CiAgICBpbXBvcnQgVHJheUFycm93VXAgZnJvbSAnc3ZlbHRlLW1hdGVyaWFsLWljb25zL1RyYXlBcnJvd1VwLnN2ZWx0ZSc7CiAgICBpbXBvcnQgeyBnZXROb3RpZmljYXRpb25zQ29udGV4dCB9IGZyb20gJ3N2ZWx0ZS1ub3RpZmljYXRpb25zJzsKICAgIGltcG9ydCB0eXBlIHsgQXBwIH0gZnJvbSAnLi4vLi4vYXBwJzsKICAgIGltcG9ydCBJbXBvcnREaWFsb2cgZnJvbSAnLi4vLi4vbGliL2NvbXBvbmVudHMvZGlhbG9ncy9JbXBvcnREaWFsb2cuc3ZlbHRlJzsKICAgIGltcG9ydCBEb3QgZnJvbSAnLi4vLi4vbGliL2NvbXBvbmVudHMvRG90LnN2ZWx0ZSc7CiAgICBpbXBvcnQgU2VsZWN0IGZyb20gJy4uLy4uL2xpYi9jb21wb25lbnRzL1NlbGVjdC5zdmVsdGUnOwogICAgaW1wb3J0IHR5cGUgeyBFdmVudCBhcyBFdmVudENvbnRyb2xsZXIgfSBmcm9tICcuLi8uLi9saWIvY29udHJvbGxlcnMvZXZlbnQnOwogICAgaW1wb3J0IHR5cGUgeyBMYWJlbCB9IGZyb20gJy4uLy4uL2xpYi9jb250cm9sbGVycy9sYWJlbCc7CiAgICBpbXBvcnQgeyBldmVudHNTb3J0S2V5LCBvYmZ1c2NhdGVkIH0gZnJvbSAnLi4vLi4vbGliL3N0b3Jlcyc7CiAgICBpbXBvcnQgeyBhcGkgfSBmcm9tICcuLi8uLi9saWIvdXRpbHMvYXBpUmVxdWVzdCc7CiAgICBpbXBvcnQgeyBkaXNwbGF5Tm90aWZPbkVyciB9IGZyb20gJy4uLy4uL2xpYi91dGlscy9ub3RpZmljYXRpb25zJzsKICAgIGltcG9ydCB7IHNob3dQb3B1cCB9IGZyb20gJy4uLy4uL2xpYi91dGlscy9wb3B1cHMnOwogICAgaW1wb3J0IHsgbm93UyB9IGZyb20gJy4uLy4uL2xpYi91dGlscy90aW1lJzsKICAgIGltcG9ydCB0eXBlIHsgRXZlbnRzU29ydEtleSB9IGZyb20gJy4uLy4uL2xpYi91dGlscy90eXBlcyc7CiAgICBpbXBvcnQgRXZlbnQgZnJvbSAnLi9FdmVudC5zdmVsdGUnOwoKICAgIGNvbnN0IE5FV19FVkVOVF9OQU1FID0gJ05ldyBFdmVudCc7CgogICAgY29uc3QgeyBhZGROb3RpZmljYXRpb24gfSA9IGdldE5vdGlmaWNhdGlvbnNDb250ZXh0KCk7CgogICAgZXhwb3J0IGxldCBkYXRhOiBBcHAuUGFnZURhdGEgJiB7CiAgICAgICAgZXZlbnRzOiBFdmVudENvbnRyb2xsZXJbXTsKICAgICAgICBsYWJlbHM6IExhYmVsW107CiAgICB9OwoKICAgIHR5cGUgRXZlbnREYXRhID0gRXZlbnRDb250cm9sbGVyICYgeyBkZWxldGVkPzogdHJ1ZSB9OwoKICAgIGxldCBldmVudHM6IEV2ZW50RGF0YVtdID0gZGF0YS5ldmVudHM7CgogICAgZnVuY3Rpb24gc29ydEV2ZW50czxUIGV4dGVuZHMgRXZlbnQgfCBFdmVudERhdGE+ICgKICAgICAgICBldmVudHM6IFRbXSwKICAgICAgICBrZXk6IEV2ZW50c1NvcnRLZXkgJiBrZXlvZiBULAogICAgKTogVFtdIHsKICAgICAgICBpZiAoZXZlbnRzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIFtdOwogICAgICAgIGlmICh0eXBlb2YgZXZlbnRzWzBdW2tleV0gPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgIHJldHVybiBldmVudHMuc29ydCgoYSwgYikgPT4gewogICAgICAgICAgICAgICAgcmV0dXJuIChhW2tleV0gYXMgc3RyaW5nKS5sb2NhbGVDb21wYXJlKGJba2V5XSBhcyBzdHJpbmcpOwogICAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBldmVudHNbMF1ba2V5XSA9PT0gJ251bWJlcicpIHsKICAgICAgICAgICAgcmV0dXJuIGV2ZW50cy5zb3J0KChhLCBiKSA9PiB7CiAgICAgICAgICAgICAgICByZXR1cm4gYltrZXldIC0gYVtrZXldOwogICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIHNvcnQga2V5Jyk7CiAgICB9CgogICAgYXN5bmMgZnVuY3Rpb24gcmVsb2FkRXZlbnRzICgpIHsKICAgICAgICBldmVudHMgPSBzb3J0RXZlbnRzKAogICAgICAgICAgICBkaXNwbGF5Tm90aWZPbkVycihhZGROb3RpZmljYXRpb24sIGF3YWl0IGFwaS5nZXQoZGF0YSwgJy9ldmVudHMnKSkKICAgICAgICAgICAgICAgIC5ldmVudHMsCiAgICAgICAgICAgICRldmVudHNTb3J0S2V5LAogICAgICAgICk7CiAgICB9CgogICAgJDogZXZlbnRzID0gc29ydEV2ZW50cyhldmVudHMsICRldmVudHNTb3J0S2V5KTsKCiAgICBhc3luYyBmdW5jdGlvbiBuZXdFdmVudCAoKSB7CiAgICAgICAgY29uc3Qgbm93ID0gbm93UygpOwogICAgICAgIGRpc3BsYXlOb3RpZk9uRXJyKAogICAgICAgICAgICBhZGROb3RpZmljYXRpb24sCiAgICAgICAgICAgIGF3YWl0IGFwaS5wb3N0KGRhdGEsICcvZXZlbnRzJywgewogICAgICAgICAgICAgICAgbmFtZTogTkVXX0VWRU5UX05BTUUsCiAgICAgICAgICAgICAgICBzdGFydDogbm93LAogICAgICAgICAgICAgICAgZW5kOiBub3csCiAgICAgICAgICAgIH0pLAogICAgICAgICk7CgogICAgICAgIGF3YWl0IHJlbG9hZEV2ZW50cygpOwogICAgfQoKICAgIGFzeW5jIGZ1bmN0aW9uIGhhbmRsZURlbGV0ZUV2ZW50ICh7CiAgICAgICAgZGV0YWlsOiBldmVudCwKICAgIH06IEN1c3RvbUV2ZW50PEV2ZW50Q29udHJvbGxlcj4pIHsKICAgICAgICBhd2FpdCByZWxvYWRFdmVudHMoKTsKCiAgICAgICAgY29uc3QgZGVsZXRlZEV2ZW50OiBFdmVudERhdGEgPSB7CiAgICAgICAgICAgIC4uLmV2ZW50LAogICAgICAgICAgICBkZWxldGVkOiB0cnVlLAogICAgICAgIH07CgogICAgICAgIGV2ZW50cyA9IFsgLi4uZXZlbnRzLCBkZWxldGVkRXZlbnQgXS5zb3J0KAogICAgICAgICAgICAoYSwgYikgPT4gYi5jcmVhdGVkIC0gYS5jcmVhdGVkLAogICAgICAgICk7CiAgICB9CgogICAgZnVuY3Rpb24gaW1wb3J0UG9wdXAgKCkgewogICAgICAgIHNob3dQb3B1cCgKICAgICAgICAgICAgSW1wb3J0RGlhbG9nLAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICBhdXRoOiBkYXRhLAogICAgICAgICAgICAgICAgdHlwZTogJ2V2ZW50cycsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHJlbG9hZEV2ZW50cywKICAgICAgICApOwogICAgfQoKICAgIGZ1bmN0aW9uIGNoYW5nZUV2ZW50Q291bnQgKGJ5OiBudW1iZXIpIHsKICAgICAgICBldmVudENvdW50ICs9IGJ5OwogICAgfQoKICAgIGxldCBldmVudENvdW50OiBudW1iZXI7CiAgICAkOiBldmVudENvdW50ID0gZXZlbnRzLmZpbHRlcihlID0+ICFlLmRlbGV0ZWQpLmxlbmd0aDsKCiAgICBsZXQgc2VsZWN0TmFtZUlkOiBzdHJpbmc7CiAgICAkOiBzZWxlY3ROYW1lSWQgPQogICAgICAgIGV2ZW50c1tldmVudHMuZmluZEluZGV4KGUgPT4gZS5uYW1lID09PSBORVdfRVZFTlRfTkFNRSAmJiAhZS5kZWxldGVkKV0KICAgICAgICAgICAgPy5pZCB8fCAnJzsKCiAgICBjb25zdCBzb3J0RXZlbnRzS2V5cyA9IHsKICAgICAgICBjcmVhdGVkOiAnY3JlYXRlZCcsCiAgICAgICAgc3RhcnQ6ICdzdGFydCcsCiAgICAgICAgZW5kOiAnZW5kJywKICAgICAgICBuYW1lOiAnbmFtZScsCiAgICB9OwoKICAgIG9uTW91bnQoKCkgPT4gKGRvY3VtZW50LnRpdGxlID0gYEV2ZW50c2ApKTsK">{}</script>

<svelte:head>
    <title>Events</title>
    <meta content="Events" name="description" />
</svelte:head>

<main>
    <div class="menu">
        <div class="flex-center">
            <button class="primary with-icon" on:click="{newEvent}">
                <Plus size="30" />
                New Event
            </button>
            <button
                class="with-icon icon-gradient-on-hover"
                on:click="{importPopup}"
            >
                <TrayArrowUp size="30" />
                Import
            </button>
        </div>

        <h1>
            <Calendar size="40" />
            <span>
                Events
                {#if eventCount > 0}
                    <Dot />
                    {eventCount}
                {/if}
            </span>
        </h1>

        <div class="flex-center">
            Sort by
            <Select bind:key="{$eventsSortKey}" options="{sortEventsKeys}" />
        </div>
    </div>
    <ul>
        {#each events as event}
            <li>
                <Event
                    event="{event}"
                    auth="{data}"
                    selectNameId="{selectNameId}"
                    changeEventCount="{changeEventCount}"
                    on:update="{reloadEvents}"
                    on:delete="{handleDeleteEvent}"
                    labels="{data.labels}"
                    obfuscated="{$obfuscated}"
                />
            </li>
        {/each}
    </ul>
</main>

<style lang="less" ✂prettier:content✂="CiAgICBAaW1wb3J0ICcuLi8uLi9zdHlsZXMvdmFyaWFibGVzJzsKICAgIEBpbXBvcnQgJy4uLy4uL3N0eWxlcy9sYXlvdXQnOwoKICAgIC8vIExheW91dCBkb2Vzbid0IHJlYWxseSB3b3JrIGJlbG93IDc1MHB4LCBzbyBzYXkgdGhhdAogICAgLy8gJ21vYmlsZScgaXMgYW55dGhpbmcgYmVsb3cgdGhhdAogICAgQG1vYmlsZTogfidvbmx5IHNjcmVlbiBhbmQgKG1heC13aWR0aDogNzUwcHgpJzsKCiAgICBoMSB7CiAgICAgICAgLmZsZXgtY2VudGVyKCk7CiAgICAgICAgbWFyZ2luOiAwOwogICAgICAgIGZvbnQtc2l6ZTogNDBweDsKCiAgICAgICAgaSB7CiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC41ZW07CiAgICAgICAgICAgIG1hcmdpbi1sZWZ0OiAwLjVlbTsKICAgICAgICB9CgogICAgICAgIHNwYW4gewogICAgICAgICAgICBtYXJnaW4tbGVmdDogMC4yZW07CiAgICAgICAgfQogICAgfQoKICAgIHVsIHsKICAgICAgICBsaXN0LXN0eWxlOiBub25lOwogICAgICAgIHBhZGRpbmc6IDA7CiAgICAgICAgZGlzcGxheTogZ3JpZDsKICAgICAgICBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IDUwJSA1MCU7CgogICAgICAgIEBtZWRpYSBAbW9iaWxlIHsKICAgICAgICAgICAgZ3JpZC10ZW1wbGF0ZS1jb2x1bW5zOiAxMDAlOwogICAgICAgICAgICBtYXJnaW46IDA7CiAgICAgICAgfQogICAgfQoKICAgIC5tZW51IHsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjsKICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOwogICAgICAgIG1hcmdpbi1ib3R0b206IDFlbTsKCiAgICAgICAgQG1lZGlhIEBtb2JpbGUgewogICAgICAgICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uOwogICAgICAgICAgICBhbGlnbi1pdGVtczogZmxleC1zdGFydDsKICAgICAgICB9CgogICAgICAgIGJ1dHRvbiB7CiAgICAgICAgICAgIEBtZWRpYSBAbW9iaWxlIHsKICAgICAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDFlbTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0K"></style>